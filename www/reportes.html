<!DOCTYPE html>
<html>

    <head>
        {{headContent()}}
        <title>IRACE GUI - Reports</title>
        <script src="shared/jquery.js" type="text/javascript"></script>
        <script src="shared/shiny.js" type="text/javascript"></script>
        <script src="resources/scripts/main.js" type="text/javascript"></script>
        <link rel="stylesheet" type="text/css" href="shared/shiny.css"/>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
        <script>tinymce.init({selector:'textarea'});</script>

        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
  
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.js"></script>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand" href="#" style="font-size: 55px;">IRACE</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarText">
                <ul class="navbar-nav mr-auto">
                <li class="nav-item" style="padding-left: 150px; font-size: 30px;">
                    <a class="nav-link" href="#">Setup</a>
                </li>
                <li class="nav-item" style="padding-left: 150px; font-size: 30px;">
                    <a class="nav-link" href="#">Runtime</a>
                </li>
                <li class="nav-item active" style="padding-left: 150px; font-size: 30px; color: green;">
                    <a class="nav-link" href="#">Reports<span class="sr-only">(current)</span></a>
                 </li>
                </ul>
                <span class="navbar-text">
                    <div class="container">
                        <div class="row">
                            Status
                        </div>
                        <div class="row">
                            <br><img src="resources/images/finished.png" width="20" height="20" alt="Status: Finished"><br>
                        </div>
                        <div class="row">
                            Finished
                        </div>
                    </div>
                </span>
            </div>
        </nav>
        <br>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-2">
                    <div class="mini-submenu">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </div>
                    <div class="list-group">
                        <span href="#" class="list-group-item active">
                            MENU
                            <span class="pull-right" id="slide-submenu">
                                <i class="fa fa-times"></i>
                            </span>
                        </span>
                        <a href="" class="list-group-item">
                            <i class="fa fa-comment-o"></i> Save PDF
                        </a>
                        <a href="#" class="list-group-item" color="red">
                            <i class="fa fa-bar-chart-o"></i> Save Report
                        </a>
                        <a href="#" class="list-group-item">
                            <i class="fa fa-envelope"></i> Load Report
                        </a>
                        <a href="#" class="list-group-item">
                            <i class="fa fa-envelope"></i> Go to Setup
                        </a>
                    </div>      
                </div>
                <div class="col-md-10 overflow-auto">
                    <div class="card">
                        <div class="card-header">Summary</div>
                        <div class="card=body">
                            <div class="container">
                                <div class="row">
                                    <div class="col">
                                        <table id="tablaSummary1">
                                            <tr>
                                                <th>IRACE version: </th>
                                                <td>{{ iraceVersion }}</td>
                                            </tr>
                                            <tr>
                                                <th>Number of candidate solutions: </th>
                                                <td>{{ nrow(iraceResults$allConfigurations) }}</td>
                                            </tr>
                                            <tr>
                                                <th>Number of executions: </th>
                                                <td> {{ dataState$nbIterations }}</td>
                                            </tr>
                                            <tr>
                                                <th>Total time required: </th>
                                                <td>HH:MM:SS</td>
                                            </tr>
                                            <tr>
                                                <th>Elitist new instances: </th>
                                                <td>{{ iraceResults$scenario$elitistNewInstances }}</td>
                                            </tr>
                                            <tr>
                                                <th>Elitist limit: </th>
                                                <td>{{ iraceResults$scenario$elitistLimit }}</td>
                                            </tr>  
                                            <tr>
                                                <th>nbIterations: </th>
                                                <td>{{ dataScenario$nbIterations }}</td>
                                            </tr>  
                                        </table>
                                    </div>
                                    <div class="col">
                                        <table id="tablaSummary2">
                                            <tr>
                                                <th>minNbSurvival: </th>
                                                <td>{{ dataScenario$minNbSurvival }}</td>
                                            </tr>
                                            <tr>
                                                <th>nbParameters: </th>
                                                <td>{{ dataParameters$nbParameters }}</td>
                                            </tr>
                                            <tr>
                                                <th>seed: </th>
                                                <td>{{ dataScenario$seed }}</td>
                                            </tr>
                                            <tr>
                                                <th>confidence level: </th>
                                                <td>{{ dataScenario$confidence }}</td>
                                            </tr>
                                            <tr>
                                                <th>budget: </th>
                                                <td>{{  dataScenario$budgetEstimation }}</td>
                                            </tr>  
                                            <tr>
                                                <th>mu: </th>
                                                <td>{{  dataScenario$mu }}</td>
                                            </tr>
                                            <tr>
                                                <th>deterministic: </th>
                                                <td>{{  dataScenario$deterministic }}</td>
                                            </tr>  
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-2">
                    <div class="card">
                        <div class="card-header" align="center">Contents</div>
                        <div class="card=body">
                            <div class="container" align="center">
                                <a href="#summary" class="badge badge-light" style="color: blue; font-size: 18px;">*Summary</a>
                                <a href="#candidates" class="badge badge-light" style="color: blue; font-size: 18px;">*Candidates</a>
                                <a href="#perfomance" class="badge badge-light" style="color: blue; font-size: 18px;">*Perfomance</a>
                                <a href="#details" class="badge badge-light" style="color: blue; font-size: 18px;">*Details</a>
                            </div>
                        </div>
                    </div>
                    <br>
                    <div class="card">
                        <div class="card-header" align="center">Sections</div>
                        <div class="card=body">
                            <br>
                            <div class="container" align="center" id="sectionsMenu">
                                <a href="#" class="badge badge-light" style="color: blue; font-size: 18px;">*Main Section</a>
                            </div>
                            <br>
                        </div>
                        <button type="button" class="btn btn-outline-success btn-md" role="button" onclick="createNewSection()">New section</button>
                    </div>
                </div>
                <div class="col-md-10 overflow-auto">
                    <div class="card">
                        <div class="card-header" id="bestConfiguration">Best Configuration</div>
                        <div class="card=body">
                            <div class="container">
                                <div class="row">
                                    <div class="col shiny-html-output">
                                        {{ bestConfiguration }}
                                    </div>
                                    <div class="col">
                                        {{ boxPlotBestConfiguration }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12 overflow-auto">
                    <div class="card">
                        <div class="card-header" id="candidates">Candidates</div>
                        <div class="card=body">
                            <br>
                            <div class="container">
                                <div class="row">
                                    <div class="col">
                                        {{ sliderCandidates }}
                                        {{ evaluatedAlgorithms }}
                                        {{ paralelCoordinatesCandidates }}
                                    </div>
                                    <div class="col">
                                        <br>
                                        <br>
                                        <br>
                                        {{ frecuencyParameters }}
                                    </div>
                                </div>
                            </div>
                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12 overflow-auto">
                    <div class="card">
                        <div class="card-header" id="perfomance">Perfomance</div>
                        <div class="card=body">
                            <br>
                            <div class="container">
                                <div class="row">
                                    <div class="col">
                                        {{ selectIterationPerfomance }}
                                        {{ evaluatedAlgorithms }}
                                    </div>
                                    <div class="col">
                                        {{ boxPlotPerfomance }}
                                    </div>
                                </div>
                            </div>
                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-md-12 overflow-auto">
                    <div class="card">
                        <div class="card-header" id="details">Details by iteration</div>
                        <div class="card=body">
                            <br>
                            <div class="container">
                                <div class="row justify-content-center">
                                    {{ selectDetailsIteration }}
                                </div>
                                <div class="row">
                                    <div class="col shiny-html-output">
                                        {{ selectedIteration }}
                                    </div>
                                </div>
                            </div>
                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <br>
    </body>
</html>
<script>
window.onload = function(){
    setTimeout(function(){
        $('table.display').DataTable();
    }, 1000);
    updateInput();
}

function updateInput()
{
    var select = document.getElementById('iterationDetails')
    select.setAttribute('onchange','setDatatables();');
}

function setDatatables(){
    setTimeout(function(){
        $('table.display').DataTable();
    }, 100);
}
function createNewSection()
{
    var newSectionName = prompt("Please, enter the name for the new section:", "New Section");
    if (newSectionName == null || newSectionName == "")
        alert("User cancelled the prompt.");
    else
    {
        var newSection = document.createElement('a');
        var randomNum = Math.floor(Math.random() * 101);
        newSection.href = "#" + newSectionName.replace(/\s/g, "") + randomNum + 'Frame';
        newSection.className = "badge badge-light";
        newSection.id = newSectionName.replace(/\s/g, "") + randomNum;
        newSection.style = "color: lightblue; font-size: 18px;";

        var div = document.getElementById('sectionsMenu');
        var idNewSection = '#' + (newSectionName.replace(/\s/g, "")) + randomNum;
        div.appendChild(newSection);
        $(idNewSection).text('*' + newSectionName);
        insertHTMLSection(newSectionName.replace(/\s/g, "") + randomNum, newSectionName)
    }
}
function insertHTMLSection(id, name)
{
    var textData = 
    '<div class="container">' + 
        '<div class="row justify-content-center">' +
            '<div class="col-md-12 overflow-auto">' +
                '<div class="card">' +
                        '<div class="card-header" id="' + id + 'Frame">' + name + '</div>' + 
                        '<div class="card=body">' + 
                            '<br>' +
                            '<div class="container">' +
                                '<div class="row">' +
                                    '<div class="col">' + 
                                        '<textarea>Write yours annotations here</textarea>' +
                                    '</div>' +
                                    '<div class="col" id="' + id + 'Images">' + 
                                        'Images and plots:' +
                                        '<br>' +
                                    '</div>' +
                                '</div>' +
                            '</div>' +
                            '<br>' +
                        '</div>' +
                    '</div>' + 
                '</div>' +
            '</div>' +
        '</div>' +
    '<br>'
    var div = document.getElementsByTagName("BODY")[0];
    div.insertAdjacentHTML('beforeend', textData);
}
</script>